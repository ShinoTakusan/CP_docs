# ABC145

## D問題

[ソースコード](https://atcoder.jp/contests/abc145/submissions/12553272)

**フェルマーの小定理、数学、組み合わせ**：この問題は、入力より、BFSで解くのは無理だとわかるので、数学的な考察を試みる。まずは、ナイトの行動の特性より、必ず$$X+Y$$は3の倍数になることが分かる。ここで次のような方程式を考える。n:=(1,2)の行動回数、m:=(2,1)の行動回数とすると、

$$
\begin{aligned}
n + 2m = X\\
2n + m = Y
\end{aligned}
$$

となる。この連立方程式より、m,nを確定させることができ、あとは(X,Y)に到達する組み合わせを計算すればよい。その組み合わせは$${}_{n+m} C _n$$である。つまり、総合行動回数のうち、n選んだ組み合わせが今回の解である。(ABC156のD問題)[./156.md] と同様に、フェルマーの小定理や、繰り返し自乗法を使うことで$$O(m + m logmod)$$(modは$$10^9 + 7$$)である。

[繰り返し自乗法](../Algorithm/repeartedSquareMethod.md)

※もっと工夫すると解説にあるように$$O(n+m+logmod)$$や$$O(min(n,m))$$となる。

参考：[解説pdf](https://img.atcoder.jp/abc145/editorial.pdf)